<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
  <head>
    <meta name="generator" content="HTML Tidy for Windows (vers 14 February 2006), see www.w3.org">
    <title>
      Alex's Hitches :: Google Calendar Testing
    </title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js" type="text/javascript"></script>
  </head>
  <body>
      <img src="testLogo1.png" alt="Test Logo" />
      <button onclick="main()">Get Calendars</button>
      <button onclick="addEvent()">Add Event</button>
    <script src="http://www.google.com/jsapi?key=ABQIAAAAp7doBy2ERdW592PKG_FObhSrvhjzeNPwIuOw4du7FJJJfT0QkRQLkQ3WynVEJrvw7f6oXv-Zm7PH5A" type="text/javascript">
</script>
<script type="text/javascript">

    google.load("gdata", "1");
    google.setOnLoadCallback(main);
    var calendarService = "";
    var feedUri = "http://www.google.com/calendar/feeds/ninnemana@gmail.com/private/full";
    
    function main() {

        var scope = 'http://www.google.com/calendar/feeds/ninnemana@gmail.com/private/full';

        if (!google.accounts.user.checkLogin(scope)) {
            var loginButton = $("<button>Click here to login</button>");
            loginButton.click(function() {
                var token = google.accounts.user.login(scope); // can ignore returned token  
            });
            $("body").append(loginButton);
        } else {

            calendarService = new google.gdata.calendar.CalendarService("ninnemana-eLocal-1.0");
            
            calendarService.getAllCalendarsFeed(feedUri, callback, handleError);
            $('body').append();
        }
    }
    
    function addEvent(){
        calendarService = new google.gdata.calendar.CalendarService("ninnemana-eLocal-1.0");
        var entry = new google.gdata.calendar.CalendarEventEntry();
        entry.setTitle(google.gdata.Text.create('JS-Client: insert event'));

        var when = new google.gdata.When();
        var startTime = google.gdata.DateTime.fromIso8601("2011-04-15T09:00:00.00-08:00");
        var endTime = google.gdata.DateTime.fromIso8601("2011-04-15T10:00:00.00-08:00");
        when.setStartTime(startTime);
        when.setEndTime(endTime);

        entry.addTime(when);
        
        calendarService.insertEntry(feedUri, entry, callback, handleError, google.gdata.calendar.CalendarEventEntry);
        
    }

	var callback = function (result) {
            var html = "<iframe src='https://www.google.com/calendar/embed?src="+result.feed.author[0].email.$t+"&ctz=America/Chicago' style='border: 0' width='800' height='600' frameborder='0' scrolling='no'></iframe>";
            $('body').append(html);
	}
	
	var handleError = function (error) {
		console.log(error);
	}

    $(document).ready(function () {

        $('.tab').live('click', function () {

            var loc = $(this).attr('href');

            $('.cal_action').hide();

            $('#calendar_actions li a').removeClass('active');

            $(this).addClass('active');

            $(loc).slideDown();



        });

    });

    </script>
  </body>
</html>
